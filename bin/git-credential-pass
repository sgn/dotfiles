#!/bin/sh

get_pass () {
	while read -r line ; do
		case $line in
		protocol=*) protocol=${line#protocol=} ;;
		username=*) username=${line#username=} ;;
		esac
		if [ "$protocol" = 'smtp' ] && [ -n "$username" ] ; then
			printf 'password=%s' $(pass "mail/offline/$username" | head -n 1)
		fi
	done
}

case "$1" in
get) get_pass ;;
esac
