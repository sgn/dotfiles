#!/bin/sh
if test "${0##*/}" = "emc" ; then
	## Force terminal mode
	param="-t"
else
	## If Emacs cannot start in graphical mode, -c will act just like -t.
	param="-c"
fi

if [ $# -eq 1 ] && [ $1 = '-' ]; then
	tempfile=$(mktemp -t "emacs-stdin.XXXXXX")
	cat >"$tempfile"
	emacsclient $param -a "" \
		--eval "(progn
			(find-file \"$tempfile\")
			(auto-save-mode 0)
			(set-visited-file-name nil)
			(rename-buffer \"*stdin*\" t))"
#	rm -f "$tempfile"
else
	exec emacsclient $param -a "" "$@"
fi
