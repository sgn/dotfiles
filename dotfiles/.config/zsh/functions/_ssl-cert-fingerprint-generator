#!/bin/sh
ssl_hashes="sha512 sha256 sha1 md5"

echo '# Generated by _ssl-cert-fingerprint-generator'

for sh in ${ssl_hashes}; do
	cat <<EOF
ssl-cert-${sh}() {
	emulate -L zsh
	if [[ -z \$1 ]] ; then
		printf 'usage: ssh-cert-${sh} <file>\n'
		return 1
	fi
	openssl x509 -noout -fingerprint -${sh} -in "\$1"
}
EOF
done

cat <<EOF
ssl-cert-fingerprint () {
	emulate -L zsh
	local i
	if [[ -z \$1 ]] ; then
		printf 'usage: ssl-cert-fingerprints <file>\n'
		return 1
	fi
EOF
for i in ${ssl_hashes}; do
	printf '	ssl-cert-%s "$1"\n' "$i"
done
cat <<EOF
}
ssl-cert-fingerprint "\$@"
EOF
