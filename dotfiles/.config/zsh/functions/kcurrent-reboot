# vi: ft=zsh
kernel=/boot/vmlinuz-$(uname -r)
initrd=/boot/initramfs-$(uname -r).img
if [ -f "$kernel" ] && [ -f "$initrd" ]; then
	if (( UID == 0 )); then
		kexec -l --initrd=$initrd --command-line="$(cat /proc/cmdline)" $kernel
	elif command -v sudo >/dev/null 2>&1; then
		sudo -k
		echo "sudo kexec -l --initrd=$initrd --command-line=\"$(cat /proc/cmdline)\" $kernel"
		sudo kexec -l --initrd=$initrd --command-line="$(cat /proc/cmdline)" $kernel
	fi
fi
