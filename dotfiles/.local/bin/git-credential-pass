#!/bin/sh

get_pass () {
	while read -r line ; do
		case $line in
		protocol=*)
			protocol=${line#*=}
			;;
		username=*)
			username=${line#*=}
			;;
		*)
			;;
		esac
		if [ "$protocol" = 'smtp' ] && [ -n "$username" ] ; then
			printf 'password=%s' $(pass "mail/offline/$username" | sed -n '1p')
		fi
	done
}

case "$@" in
get)
	get_pass
	;;
*)
	;;
esac
